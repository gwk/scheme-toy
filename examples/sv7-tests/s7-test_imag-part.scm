(num-test (imag-part -0.0+0.00000001i) 0.00000001)
(num-test (imag-part -0.0+1234.0i) 1234.0)
(num-test (imag-part -0.0-3.14159265358979i) -3.14159265358979)
(num-test (imag-part -0.00000001+1.0i) 1.0)
(num-test (imag-part -0.00000001+1234000000.0i) 1234000000.0)
(num-test (imag-part -0.00000001-0.0i) 0.0)
(num-test (imag-part -0.00000001-2.71828182845905i) -2.71828182845905)
(num-test (imag-part -1.0+3.14159265358979i) 3.14159265358979)
(num-test (imag-part -1.0-0.00000001i) -0.00000001)
(num-test (imag-part -1.0-1234.0i) -1234.0)
(num-test (imag-part -1234.0+1.0i) 1.0)
(num-test (imag-part -1234.0+1234000000.0i) 1234000000.0)
(num-test (imag-part -1234.0-0.0i) 0.0)
(num-test (imag-part -1234.0-2.71828182845905i) -2.71828182845905)
(num-test (imag-part -1234000000.0+3.14159265358979i) 3.14159265358979)
(num-test (imag-part -1234000000.0-0.00000001i) -0.00000001)
(num-test (imag-part -1234000000.0-1234.0i) -1234.0)
(num-test (imag-part -2.0) 0.0)
(num-test (imag-part -2.71828182845905+0.00000001i) 0.00000001)
(num-test (imag-part -2.71828182845905+1234.0i) 1234.0)
(num-test (imag-part -2.71828182845905-3.14159265358979i) -3.14159265358979)
(num-test (imag-part -3.14159265358979+0.0i) 0.0)
(num-test (imag-part -3.14159265358979+2.71828182845905i) 2.71828182845905)
(num-test (imag-part -3.14159265358979-1.0i) -1.0)
(num-test (imag-part -3.14159265358979-1234000000.0i) -1234000000.0)
(num-test (imag-part 0+i) 1.0)
(num-test (imag-part 0.0+0.0i) 0.0)
(num-test (imag-part 0.0+2.71828182845905i) 2.71828182845905)
(num-test (imag-part 0.0-1.0i) -1.0)
(num-test (imag-part 0.0-1234000000.0i) -1234000000.0)
(num-test (imag-part 0.00000001+0.00000001i) 0.00000001)
(num-test (imag-part 0.00000001+1234.0i) 1234.0)
(num-test (imag-part 0.00000001-3.14159265358979i) -3.14159265358979)
(num-test (imag-part 1) 0.0)
(num-test (imag-part 1+i) 1.0)
(num-test (imag-part 1-i) -1.0)
(num-test (imag-part 1.0+1.0i) 1.0)
(num-test (imag-part 1.0+1234000000.0i) 1234000000.0)
(num-test (imag-part 1.0-0.0i) 0.0)
(num-test (imag-part 1.0-2.71828182845905i) -2.71828182845905)
(num-test (imag-part 1.4+0.0i) 0.0)
(num-test (imag-part 1234.0+0.00000001i) 0.00000001)
(num-test (imag-part 1234.0+1234.0i) 1234.0)
(num-test (imag-part 1234.0-3.14159265358979i) -3.14159265358979)
(num-test (imag-part 1234000000.0+1.0i) 1.0)
(num-test (imag-part 1234000000.0+1234000000.0i) 1234000000.0)
(num-test (imag-part 1234000000.0-0.0i) 0.0)
(num-test (imag-part 1234000000.0-2.71828182845905i) -2.71828182845905)
(num-test (imag-part 2.71828182845905+0.0i) 0.0)
(num-test (imag-part 2.71828182845905+2.71828182845905i) 2.71828182845905)
(num-test (imag-part 2.71828182845905-1.0i) -1.0)
(num-test (imag-part 2.71828182845905-1234000000.0i) -1234000000.0)
(num-test (imag-part 2/3) 0.0)
(num-test (imag-part 3.14159265358979+3.14159265358979i) 3.14159265358979)
(num-test (imag-part 3.14159265358979-0.00000001i) -0.00000001)
(num-test (imag-part 3.14159265358979-1234.0i) -1234.0)
(num-test (imag-part 5) 0.0)
(num-test (imag-part -1.797693134862315699999999999999999999998E308) 0.0)
(num-test (imag-part -2.225073858507201399999999999999999999996E-308) 0.0)
(num-test (imag-part -9223372036854775808) 0)
(num-test (imag-part 1.110223024625156799999999999999999999997E-16) 0.0)
(num-test (imag-part 9223372036854775807) 0)
(test (imag-part inf.0) 0.0)
(num-test (imag-part (+ 2 0+1/0i)) inf.0)
(num-test (imag-part 0/0+0i) 0.0)
(num-test (imag-part 1/0) 0.0)
;(num-test (imag-part (log 1/0)) pi) ; hmmm -- I could imagine other choices here and below
;(num-test (imag-part (sqrt 1/0)) 0.0)
;(test (nan? (imag-part (sqrt (log 1/0)))) #t)

(if with-bignums
    (begin
      (num-test (imag-part 0+1e400i) 1e400)
      (num-test (imag-part 0+9223372036854775808.0i) 9223372036854775808.0)
      (num-test (imag-part 1.5+9223372036854775808.0i) 9.223372036854775808E18)
      (num-test (imag-part 9223372036854775808.0) 0)
      (num-test (imag-part 9223372036854775808.0+1.5i) 1.5)
      ))

(test (imag-part "hi") 'error)
(test (imag-part 1.0+23.0i 1.0+23.0i) 'error)
(test (imag-part) 'error)

(for-each
 (lambda (arg)
   (test (imag-part arg) 'error))
 (list "hi" '() (integer->char 65) #f #t '(1 2) _ht_ 'a-symbol (cons 1 2) (make-vector 3) abs 
       #<eof> '(1 2 3) #\newline (lambda (a) (+ a 1)) #<unspecified> #<undefined>))
