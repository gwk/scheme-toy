(num-test (ceiling #e-01-0i ) -1)
(num-test (ceiling (- (+ 1 -1/123400000))) 0)
(num-test (ceiling (- 1 1/123400000)) 1)
(num-test (ceiling (/ (- most-positive-fixnum 1) most-positive-fixnum)) 1)
(num-test (ceiling (/ -1 most-positive-fixnum)) 0)
(num-test (ceiling (/ 1 most-positive-fixnum)) 1)
(num-test (ceiling (/ most-negative-fixnum most-positive-fixnum)) -1)
(num-test (ceiling (/ most-positive-fixnum (- most-positive-fixnum 1))) 2)
(num-test (ceiling -.0001) 0)
(num-test (ceiling -0) 0)
(num-test (ceiling -0.0) 0)
(num-test (ceiling -0.1) 0)
(num-test (ceiling -0.9) 0)
(num-test (ceiling -1) -1)
(num-test (ceiling -1.1) -1)
(num-test (ceiling -1.9) -1)
(num-test (ceiling -1/10) 0)
(num-test (ceiling -1/123400000) 0)
(num-test (ceiling -1/2) 0)
(num-test (ceiling -100/3) -33)
(num-test (ceiling -11/10) -1)
(num-test (ceiling -17/2) -8)
(num-test (ceiling -19/10) -1)
(num-test (ceiling -2.225073858507201399999999999999999999996E-308) 0)
(num-test (ceiling -2/3) 0)
(num-test (ceiling -200/3) -66)
(num-test (ceiling -2147483647.8) -2147483647)
(num-test (ceiling -3/2) -1)
(num-test (ceiling -9/10) 0)
(num-test (ceiling -9223372036854775808) -9223372036854775808)
(num-test (ceiling .0001) 1)
(num-test (ceiling 0) 0)
(num-test (ceiling 0.0) 0)
(num-test (ceiling 0.1) 1)
(num-test (ceiling 0.9) 1)
(num-test (ceiling 1) 1)
(num-test (ceiling 1.01e-123) 1)
(num-test (ceiling 1.1) 2)
(num-test (ceiling 1.110223024625156799999999999999999999997E-16) 1)
(num-test (ceiling 1.9) 2)
(num-test (ceiling 1/10) 1)
(num-test (ceiling 1/123400000) 1)
(num-test (ceiling 1/2) 1)
(num-test (ceiling 100/3) 34)
(num-test (ceiling 11/10) 2)
(num-test (ceiling 17.3) 18)
(num-test (ceiling 19) 19)
(num-test (ceiling 19/10) 2)
(num-test (ceiling 2.4) 3)
(num-test (ceiling 2.5) 3)
(num-test (ceiling 2.6) 3)
(num-test (ceiling 2/3) 1)
(num-test (ceiling 200/3) 67)
(num-test (ceiling 2147483646.8) 2147483647)
(num-test (ceiling 3/2) 2)
(num-test (ceiling 9/10) 1)
(num-test (ceiling 9223372036854775807) 9223372036854775807)
(num-test (ceiling most-negative-fixnum) most-negative-fixnum)
(num-test (ceiling most-positive-fixnum) most-positive-fixnum)
(num-test (ceiling 8922337203685477.9) 8922337203685478)

(if with-bignums
    (begin
      (num-test (ceiling 8388608.0000000005) 8388609)
      (num-test (ceiling 8388609.0000000005) 8388610)
      (num-test (ceiling 8388607.9999999995) 8388608)
      (num-test (ceiling 9223372036854775806.9) 9223372036854775807)
      )
    (begin
      (test (ceiling 1e308) 'error)
      (test (ceiling 1e19) 'error)
      (test (ceiling -1e308) 'error)
      (test (ceiling -1e19) 'error)

      ;; but unfortunately (ceiling 9223372036854775806.9) => -9223372036854775808
      ;;                   (ceiling 922337203685477580.9)  => 922337203685477632
      ;;                   (ceiling 9223372036854770.9)    => 9223372036854770
      ))

(test (= (ceiling (* 111738283365989051/177100989030047175 1.0)) (ceiling 130441933147714940/206745572560704147)) #t)
(test (= (ceiling (* 114243/80782 114243/80782 1.0)) (ceiling (* 275807/195025 275807/195025))) #f)
(if with-bignums (test (= (ceiling (* 131836323/93222358 131836323/93222358 1.0)) (ceiling (* 318281039/225058681 318281039/225058681))) #f))
(test (= (ceiling (* 1393/985 1393/985 1.0)) (ceiling (* 3363/2378 3363/2378))) #f)
(test (= (ceiling (* 1607521/1136689 1607521/1136689 1.0)) (ceiling (* 3880899/2744210 3880899/2744210))) #f)
(if with-bignums (test (= (ceiling (* 1855077841/1311738121 1855077841/1311738121 1.0)) (ceiling (* 4478554083/3166815962 4478554083/3166815962))) #f))
(test (= (ceiling (* 19601/13860 19601/13860 1.0)) (ceiling (* 47321/33461 47321/33461))) #f)
(test (= (ceiling (* 275807/195025 275807/195025 1.0)) (ceiling (* 1607521/1136689 1607521/1136689))) #t)
(test (= (ceiling (* 318281039/225058681 318281039/225058681 1.0)) (ceiling (* 1855077841/1311738121 1855077841/1311738121))) #t)
(test (= (ceiling (* 3363/2378 3363/2378 1.0)) (ceiling (* 19601/13860 19601/13860))) #t)
(test (= (ceiling (* 3880899/2744210 3880899/2744210 1.0)) (ceiling (* 9369319/6625109 9369319/6625109))) #f)
(test (= (ceiling (* 47321/33461 47321/33461 1.0)) (ceiling (* 114243/80782 114243/80782))) #f)
(test (= (ceiling (* 54608393/38613965 54608393/38613965 1.0)) (ceiling (* 131836323/93222358 131836323/93222358))) #f)
(test (= (ceiling (* 9369319/6625109 9369319/6625109 1.0)) (ceiling (* 54608393/38613965 54608393/38613965))) #t)

(if with-bignums
    (begin
      (num-test (ceiling (+ (expt 2.0 62) 512)) 4611686018427388416)
      (num-test (ceiling (+ (expt 2.0 62) 513)) 4611686018427388417)
      (num-test (ceiling (exact->inexact most-negative-fixnum)) most-negative-fixnum)
      (test (ceiling (exact->inexact most-positive-fixnum)) most-positive-fixnum)
      (num-test (ceiling 123456789012345678901234567890.1) 123456789012345678901234567891)
      (num-test (ceiling -123456789012345678901234567890.1) -123456789012345678901234567890)

      (num-test (ceiling  9223372036854775806.7)  9223372036854775807)
      (num-test (ceiling -9223372036854775807.9) -9223372036854775807)
      (num-test (ceiling -1e19) -10000000000000000000)
      (num-test (ceiling -1e32) -100000000000000000000000000000000)
      (num-test (ceiling 100000000000000000000000000000000/3) 33333333333333333333333333333334)
      (num-test (ceiling -100000000000000000000000000000000/3) -33333333333333333333333333333333)
      (num-test (ceiling 200000000000000000000000000000000/3) 66666666666666666666666666666667)
      (num-test (ceiling -200000000000000000000000000000000/3) -66666666666666666666666666666666)

      (test (= (ceiling (* 1180872205318713601/835002744095575440 1180872205318713601/835002744095575440 1.0)) 
	       (ceiling (* 2850877693509864481/2015874949414289041 2850877693509864481/2015874949414289041))) #f)

;      (test (= (ceiling (* 1362725501650887306817/963592443113182178088 1362725501650887306817/963592443113182178088 1.0)) 
;	       (ceiling (* 3289910387877251662993/2326317944764069484905 3289910387877251662993/2326317944764069484905))) #f)
;;; this requires much more precision (2048 bits)
      (test (= (ceiling (* 1362725501650887306817/963592443113182178088 1362725501650887306817/963592443113182178088)) 
	       (ceiling (* 3289910387877251662993/2326317944764069484905 3289910387877251662993/2326317944764069484905))) #f)

      (test (= (ceiling (* 14398739476117879/10181446324101389 14398739476117879/10181446324101389 1.0)) 
	       (ceiling (* 34761632124320657/24580185800219268 34761632124320657/24580185800219268))) #f)
      (test (= (ceiling (* 16616132878186749607/11749380235262596085 16616132878186749607/11749380235262596085 1.0)) 
	       (ceiling (* 40114893348711941777/28365513113449345692 40114893348711941777/28365513113449345692))) #f)
      (test (= (ceiling (* 19175002942688032928599/13558774610046711780701 19175002942688032928599/13558774610046711780701 1.0)) 
	       (ceiling (* 46292552162781456490001/32733777552734744709300 46292552162781456490001/32733777552734744709300))) #f)
      (test (= (ceiling (* 202605639573839043/143263821649299118 202605639573839043/143263821649299118 1.0)) 
	       (ceiling (* 489133282872437279/345869461223138161 489133282872437279/345869461223138161))) #f)
      (test (= (ceiling (* 2850877693509864481/2015874949414289041 2850877693509864481/2015874949414289041 1.0)) 
	       (ceiling (* 16616132878186749607/11749380235262596085 16616132878186749607/11749380235262596085))) #t)
      (test (= (ceiling (* 34761632124320657/24580185800219268 34761632124320657/24580185800219268 1.0)) 
	       (ceiling (* 202605639573839043/143263821649299118 202605639573839043/143263821649299118))) #t)
      (test (= (ceiling (* 489133282872437279/345869461223138161 489133282872437279/345869461223138161 1.0)) 
	       (ceiling (* 1180872205318713601/835002744095575440 1180872205318713601/835002744095575440))) #f)
      (test (= (ceiling (* 564459384575477049359/399133058537705128729 564459384575477049359/399133058537705128729 1.0)) 
	       (ceiling (* 1362725501650887306817/963592443113182178088 1362725501650887306817/963592443113182178088))) #f)
      (test (= (ceiling (* 5964153172084899/4217293152016490 5964153172084899/4217293152016490 1.0)) 
	       (ceiling (* 14398739476117879/10181446324101389 14398739476117879/10181446324101389))) #f)
      (test (= (ceiling (* 96845919575610633161/68480406462161287469 96845919575610633161/68480406462161287469 1.0)) 
	       (ceiling (* 564459384575477049359/399133058537705128729 564459384575477049359/399133058537705128729))) #t)
      ))

(let ((val1 (catch #t (lambda () (ceiling 0.0)) (lambda args 'error)))
      (val2 (catch #t (lambda () (ceiling -0.0)) (lambda args 'error))))
  (test (equal? val1 val2) #t))

(test (ceiling) 'error)
(test (ceiling 1.23+1.0i) 'error)
(test (ceiling 1.23 1.23) 'error)

(for-each
 (lambda (arg)
   (test (ceiling arg) 'error))
 (list "hi" '() (integer->char 65) #f #t '(1 2) _ht_ 'a-symbol (cons 1 2) (make-vector 3) abs 
       #<eof> '(1 2 3) #\newline (lambda (a) (+ a 1)) #<unspecified> #<undefined>))
