(num-test (remainder -0.5 -1) -0.5)
(num-test (remainder -1 -1) 0)
(num-test (remainder -1 -10) -1)
(num-test (remainder -1 -1234) -1)
(num-test (remainder -1 -1234000000) -1)
(num-test (remainder -1 -2) -1)
(num-test (remainder -1 -3) -1)
(num-test (remainder -1 -362880) -1)
(num-test (remainder -1 -500029) -1)
(num-test (remainder -1 1) 0)
(num-test (remainder -1 10) -1)
(num-test (remainder -1 1234) -1)
(num-test (remainder -1 1234000000) -1)
(num-test (remainder -1 2) -1)
(num-test (remainder -1 3) -1)
(num-test (remainder -1 362880) -1)
(num-test (remainder -1 500029) -1)
(num-test (remainder -1.5 -2) -1.5)
(num-test (remainder -1.5 2) -1.5)
(num-test (remainder -1/2 -1) -1/2)
(num-test (remainder -1/2 -1.0) -0.5)
(num-test (remainder -10 -1) 0)
(num-test (remainder -10 -10) 0)
(num-test (remainder -10 -1234) -10)
(num-test (remainder -10 -1234000000) -10)
(num-test (remainder -10 -2) 0)
(num-test (remainder -10 -3) -1)
(num-test (remainder -10 -362880) -10)
(num-test (remainder -10 -500029) -10)
(num-test (remainder -10 1) 0)
(num-test (remainder -10 10) 0)
(num-test (remainder -10 1234) -10)
(num-test (remainder -10 1234000000) -10)
(num-test (remainder -10 2) 0)
(num-test (remainder -10 3) -1)
(num-test (remainder -10 362880) -10)
(num-test (remainder -10 500029) -10)
(num-test (remainder -1234 -1) 0)
(num-test (remainder -1234 -10) -4)
(num-test (remainder -1234 -1234) 0)
(num-test (remainder -1234 -1234000000) -1234)
(num-test (remainder -1234 -2) 0)
(num-test (remainder -1234 -3) -1)
(num-test (remainder -1234 -362880) -1234)
(num-test (remainder -1234 -500029) -1234)
(num-test (remainder -1234 1) 0)
(num-test (remainder -1234 10) -4)
(num-test (remainder -1234 1234) 0)
(num-test (remainder -1234 1234000000) -1234)
(num-test (remainder -1234 2) 0)
(num-test (remainder -1234 3) -1)
(num-test (remainder -1234 362880) -1234)
(num-test (remainder -1234 500029) -1234)
(num-test (remainder -1234000000 -1) 0)
(num-test (remainder -1234000000 -10) 0)
(num-test (remainder -1234000000 -1234) 0)
(num-test (remainder -1234000000 -1234000000) 0)
(num-test (remainder -1234000000 -2) 0)
(num-test (remainder -1234000000 -3) -1)
(num-test (remainder -1234000000 -362880) -208000)
(num-test (remainder -1234000000 -500029) -428457)
(num-test (remainder -1234000000 1) 0)
(num-test (remainder -1234000000 10) 0)
(num-test (remainder -1234000000 1234) 0)
(num-test (remainder -1234000000 1234000000) 0)
(num-test (remainder -1234000000 2) 0)
(num-test (remainder -1234000000 3) -1)
(num-test (remainder -1234000000 362880) -208000)
(num-test (remainder -1234000000 500029) -428457)
(num-test (remainder -13 -4) -1)
(num-test (remainder -13 4) -1)
(num-test (remainder -2 -1) 0)
(num-test (remainder -2 -10) -2)
(num-test (remainder -2 -1234) -2)
(num-test (remainder -2 -1234000000) -2)
(num-test (remainder -2 -2) 0)
(num-test (remainder -2 -3) -2)
(num-test (remainder -2 -362880) -2)
(num-test (remainder -2 -500029) -2)
(num-test (remainder -2 1) 0)
(num-test (remainder -2 10) -2)
(num-test (remainder -2 1234) -2)
(num-test (remainder -2 1234000000) -2)
(num-test (remainder -2 2) 0)
(num-test (remainder -2 3) -2)
(num-test (remainder -2 362880) -2)
(num-test (remainder -2 500029) -2)
(num-test (remainder -3 -1) 0)
(num-test (remainder -3 -10) -3)
(num-test (remainder -3 -1234) -3)
(num-test (remainder -3 -1234000000) -3)
(num-test (remainder -3 -2) -1)
(num-test (remainder -3 -3) 0)
(num-test (remainder -3 -362880) -3)
(num-test (remainder -3 -500029) -3)
(num-test (remainder -3 1) 0)
(num-test (remainder -3 10) -3)
(num-test (remainder -3 1234) -3)
(num-test (remainder -3 1234000000) -3)
(num-test (remainder -3 2) -1)
(num-test (remainder -3 3) 0)
(num-test (remainder -3 362880) -3)
(num-test (remainder -3 500029) -3)
(num-test (remainder -3.1 -2.0) -1.1)
(num-test (remainder -3.1 2.0) -1.1)
(num-test (remainder -3.1 2.5) -0.6)
(num-test (remainder -3/2 -2) -3/2)
(num-test (remainder -3/2 2) -3/2)
(num-test (remainder -362880 -1) 0)
(num-test (remainder -362880 -10) 0)
(num-test (remainder -362880 -1234) -84)
(num-test (remainder -362880 -1234000000) -362880)
(num-test (remainder -362880 -2) 0)
(num-test (remainder -362880 -3) 0)
(num-test (remainder -362880 -362880) 0)
(num-test (remainder -362880 -500029) -362880)
(num-test (remainder -362880 1) 0)
(num-test (remainder -362880 10) 0)
(num-test (remainder -362880 1234) -84)
(num-test (remainder -362880 1234000000) -362880)
(num-test (remainder -362880 2) 0)
(num-test (remainder -362880 3) 0)
(num-test (remainder -362880 362880) 0)
(num-test (remainder -362880 500029) -362880)
(num-test (remainder -500029 -1) 0)
(num-test (remainder -500029 -10) -9)
(num-test (remainder -500029 -1234) -259)
(num-test (remainder -500029 -1234000000) -500029)
(num-test (remainder -500029 -2) -1)
(num-test (remainder -500029 -3) -1)
(num-test (remainder -500029 -362880) -137149)
(num-test (remainder -500029 -500029) 0)
(num-test (remainder -500029 1) 0)
(num-test (remainder -500029 10) -9)
(num-test (remainder -500029 1234) -259)
(num-test (remainder -500029 1234000000) -500029)
(num-test (remainder -500029 2) -1)
(num-test (remainder -500029 3) -1)
(num-test (remainder -500029 362880) -137149)
(num-test (remainder -500029 500029) 0)
(num-test (remainder 0 -1) 0)
(num-test (remainder 0 -1) 0)
(num-test (remainder 0 -10) 0)
(num-test (remainder 0 -10) 0)
(num-test (remainder 0 -1234) 0)
(num-test (remainder 0 -1234) 0)
(num-test (remainder 0 -1234000000) 0)
(num-test (remainder 0 -1234000000) 0)
(num-test (remainder 0 -2) 0)
(num-test (remainder 0 -2) 0)
(num-test (remainder 0 -3) 0)
(num-test (remainder 0 -3) 0)
(num-test (remainder 0 -362880) 0)
(num-test (remainder 0 -362880) 0)
(num-test (remainder 0 -500029) 0)
(num-test (remainder 0 -500029) 0)
(num-test (remainder 0 1) 0)
(num-test (remainder 0 1) 0)
(num-test (remainder 0 10) 0)
(num-test (remainder 0 10) 0)
(num-test (remainder 0 1234) 0)
(num-test (remainder 0 1234) 0)
(num-test (remainder 0 1234000000) 0)
(num-test (remainder 0 1234000000) 0)
(num-test (remainder 0 2) 0)
(num-test (remainder 0 2) 0)
(num-test (remainder 0 3) 0)
(num-test (remainder 0 3) 0)
(num-test (remainder 0 362880) 0)
(num-test (remainder 0 362880) 0)
(num-test (remainder 0 500029) 0)
(num-test (remainder 0 500029) 0)
(num-test (remainder 0.5 -2) 0.5)
(num-test (remainder 0.5 -2.0) 0.5)
(num-test (remainder 0.5 2.0) 0.5)
(num-test (remainder 1 -1) 0)
(num-test (remainder 1 -10) 1)
(num-test (remainder 1 -1234) 1)
(num-test (remainder 1 -1234000000) 1)
(num-test (remainder 1 -2) 1)
(num-test (remainder 1 -3) 1)
(num-test (remainder 1 -362880) 1)
(num-test (remainder 1 -4) 1)
(num-test (remainder 1 -500029) 1)
(num-test (remainder 1 1) 0)
(num-test (remainder 1 10) 1)
(num-test (remainder 1 1234) 1)
(num-test (remainder 1 1234000000) 1)
(num-test (remainder 1 2) 1)
(num-test (remainder 1 3) 1)
(num-test (remainder 1 362880) 1)
(num-test (remainder 1 500029) 1)
(num-test (remainder 1.5 1/3) 0.16666666666667)
(num-test (remainder 1.5 1/4) 0.0)
(num-test (remainder 1/2 -2) 1/2)
(num-test (remainder 1/2 2) 1/2)
(num-test (remainder 1/9223372036854775807 1/3) 1/9223372036854775807)
(num-test (remainder 10 -1) 0)
(num-test (remainder 10 -10) 0)
(num-test (remainder 10 -1234) 10)
(num-test (remainder 10 -1234000000) 10)
(num-test (remainder 10 -2) 0)
(num-test (remainder 10 -3) 1)
(num-test (remainder 10 -362880) 10)
(num-test (remainder 10 -500029) 10)
(num-test (remainder 10 1) 0)
(num-test (remainder 10 10) 0)
(num-test (remainder 10 1234) 10)
(num-test (remainder 10 1234000000) 10)
(num-test (remainder 10 2) 0)
(num-test (remainder 10 3) 1)
(num-test (remainder 10 362880) 10)
(num-test (remainder 10 500029) 10)
(num-test (remainder 11/9223372036854775807 3/9223372036854775807) 2/9223372036854775807)
(num-test (remainder 1234 -1) 0)
(num-test (remainder 1234 -10) 4)
(num-test (remainder 1234 -1234) 0)
(num-test (remainder 1234 -1234000000) 1234)
(num-test (remainder 1234 -2) 0)
(num-test (remainder 1234 -3) 1)
(num-test (remainder 1234 -362880) 1234)
(num-test (remainder 1234 -500029) 1234)
(num-test (remainder 1234 1) 0)
(num-test (remainder 1234 10) 4)
(num-test (remainder 1234 1234) 0)
(num-test (remainder 1234 1234000000) 1234)
(num-test (remainder 1234 2) 0)
(num-test (remainder 1234 3) 1)
(num-test (remainder 1234 362880) 1234)
(num-test (remainder 1234 500029) 1234)
(num-test (remainder 1234000000 -1) 0)
(num-test (remainder 1234000000 -10) 0)
(num-test (remainder 1234000000 -1234) 0)
(num-test (remainder 1234000000 -1234000000) 0)
(num-test (remainder 1234000000 -2) 0)
(num-test (remainder 1234000000 -3) 1)
(num-test (remainder 1234000000 -362880) 208000)
(num-test (remainder 1234000000 -500029) 428457)
(num-test (remainder 1234000000 1) 0)
(num-test (remainder 1234000000 10) 0)
(num-test (remainder 1234000000 1234) 0)
(num-test (remainder 1234000000 1234000000) 0)
(num-test (remainder 1234000000 2) 0)
(num-test (remainder 1234000000 3) 1)
(num-test (remainder 1234000000 362880) 208000)
(num-test (remainder 1234000000 500029) 428457)
(num-test (remainder 13 -4) 1)
(num-test (remainder 13 4) 1)
(num-test (remainder 19439282 4409.5) 2206.0)
(num-test (remainder 2 -1) 0)
(num-test (remainder 2 -10) 2)
(num-test (remainder 2 -1234) 2)
(num-test (remainder 2 -1234000000) 2)
(num-test (remainder 2 -2) 0)
(num-test (remainder 2 -3) 2)
(num-test (remainder 2 -362880) 2)
(num-test (remainder 2 -500029) 2)
(num-test (remainder 2 1) 0)
(num-test (remainder 2 10) 2)
(num-test (remainder 2 1234) 2)
(num-test (remainder 2 1234000000) 2)
(num-test (remainder 2 2) 0)
(num-test (remainder 2 3) 2)
(num-test (remainder 2 362880) 2)
(num-test (remainder 2 500029) 2)
(num-test (remainder 3 -1) 0)
(num-test (remainder 3 -10) 3)
(num-test (remainder 3 -1234) 3)
(num-test (remainder 3 -1234000000) 3)
(num-test (remainder 3 -2) 1)
(num-test (remainder 3 -3) 0)
(num-test (remainder 3 -362880) 3)
(num-test (remainder 3 -500029) 3)
(num-test (remainder 3 1) 0)
(num-test (remainder 3 10) 3)
(num-test (remainder 3 1234) 3)
(num-test (remainder 3 1234000000) 3)
(num-test (remainder 3 2) 1)
(num-test (remainder 3 2.5) 0.5)
(num-test (remainder 3 3) 0)
(num-test (remainder 3 362880) 3)
(num-test (remainder 3 500029) 3)
(num-test (remainder 3.1 -2.0) 1.1)
(num-test (remainder 3.1 2) 1.1)
(num-test (remainder 3.1 2.0) 1.1)
(num-test (remainder 3/2 1/3) 1/6)
(num-test (remainder 3/2 1/4) 0)
(num-test (remainder 3/2 3/10) 0)
(num-test (remainder 362880 -1) 0)
(num-test (remainder 362880 -10) 0)
(num-test (remainder 362880 -1234) 84)
(num-test (remainder 362880 -1234000000) 362880)
(num-test (remainder 362880 -2) 0)
(num-test (remainder 362880 -3) 0)
(num-test (remainder 362880 -362880) 0)
(num-test (remainder 362880 -500029) 362880)
(num-test (remainder 362880 1) 0)
(num-test (remainder 362880 10) 0)
(num-test (remainder 362880 1234) 84)
(num-test (remainder 362880 1234000000) 362880)
(num-test (remainder 362880 2) 0)
(num-test (remainder 362880 3) 0)
(num-test (remainder 362880 362880) 0)
(num-test (remainder 362880 500029) 362880)
(num-test (remainder 500029 -1) 0)
(num-test (remainder 500029 -10) 9)
(num-test (remainder 500029 -1234) 259)
(num-test (remainder 500029 -1234000000) 500029)
(num-test (remainder 500029 -2) 1)
(num-test (remainder 500029 -3) 1)
(num-test (remainder 500029 -362880) 137149)
(num-test (remainder 500029 -500029) 0)
(num-test (remainder 500029 1) 0)
(num-test (remainder 500029 10) 9)
(num-test (remainder 500029 1234) 259)
(num-test (remainder 500029 1234000000) 500029)
(num-test (remainder 500029 2) 1)
(num-test (remainder 500029 3) 1)
(num-test (remainder 500029 362880) 137149)
(num-test (remainder 500029 500029) 0)
(num-test (remainder -9223372036854775808 -9223372036854775808) 0)
(num-test (remainder 1.110223024625156799999999999999999999997E-16 -9223372036854775808) 1.110223024625156799999999999999999999997E-16)
(num-test (remainder 5.551115123125783999999999999999999999984E-17 1.110223024625156799999999999999999999997E-16) 5.551115123125783999999999999999999999984E-17)
(num-test (remainder 9223372036854775807 -9223372036854775808) 9223372036854775807)
(num-test (remainder 9223372036854775807 9223372036854775807) 0)

(num-test (remainder 0.0 1) 0.0)
(num-test (remainder 0.0 2) 0.0)
(num-test (remainder 0.0 3) 0.0)
(num-test (remainder 0.0 4) 0.0)
(num-test (remainder 0.0 pi) 0.0)
(num-test (remainder 0.0 2.5) 0.0)
(num-test (remainder 0.0 4.0) 0.0)
(num-test (remainder 0.0 1000.1) 0.0)
(num-test (remainder pi 1) 1.415926535897932384626433832795028841953E-1)
(num-test (remainder pi 2) 1.141592653589793238462643383279502884195E0)
(num-test (remainder pi 3) 1.415926535897932384626433832795028841953E-1)
(num-test (remainder pi 4) pi)
(num-test (remainder pi pi) 0.0)
(num-test (remainder pi 2.5) 6.415926535897932384626433832795028841953E-1)
(num-test (remainder pi 4.0) pi)
(num-test (remainder pi 1000.1) pi)
(num-test (remainder 1.5 1) 0.5)
(num-test (remainder 1.5 2) 1.5)
(num-test (remainder 1.5 3) 1.5)
(num-test (remainder 1.5 4) 1.5)
(num-test (remainder 1.5 pi) 1.500E0)
(num-test (remainder 1.5 2.5) 1.5)
(num-test (remainder 1.5 4.0) 1.5)
(num-test (remainder 1.5 1000.1) 1.5)
(num-test (remainder -1.5 1) -0.5)
(num-test (remainder -1.5 2) -1.5)
(num-test (remainder -1.5 3) -1.5)
(num-test (remainder -1.5 4) -1.5)
(num-test (remainder -1.5 pi) -1.50E0)
(num-test (remainder -1.5 2.5) -1.5)
(num-test (remainder -1.5 4.0) -1.5)
(num-test (remainder -1.5 1000.1) -1.5)
(num-test (remainder 3.0 1) 0.0)
(num-test (remainder 3.0 2) 1.0)
(num-test (remainder 3.0 3) 0.0)
(num-test (remainder 3.0 4) 3.0)
(num-test (remainder 3.0 pi) 3.000E0)
(num-test (remainder 3.0 2.5) 0.5)
(num-test (remainder 3.0 4.0) 3.0)
(num-test (remainder 3.0 1000.1) 3.0)
(num-test (remainder 110.123 1) 0.123)
(num-test (remainder 110.123 2) 0.123)
(num-test (remainder 110.123 3) 2.123)
(num-test (remainder 110.123 4) 2.123)
(num-test (remainder 110.123 pi) 1.672571243572413149678281714746183675874E-1)
(num-test (remainder 110.123 2.5) 0.123)
(num-test (remainder 110.123 4.0) 2.123)
(num-test (remainder 110.123 1000.1) 110.123)

(num-test (remainder 3/2 most-negative-fixnum) 3/2)
(num-test (remainder 3/2 most-positive-fixnum) 3/2)
(num-test (remainder most-negative-fixnum -1) 0)

(test (= (remainder (* 577/408 577/408) 2) (remainder (* 1393/985 1393/985) 2)) #f)
(test (= (remainder 2.0 (* 577/408 577/408)) (remainder (* 1393/985 1393/985) 2.0)) #f)
(test (= (remainder 577/408 1393/985) (floor (/ 577/408 1393/985))) #f)
(test (= (remainder (* 3363/2378 3363/2378) 2) (remainder (* 19601/13860 19601/13860) 2)) #f)
(test (= (remainder 2.0 (* 47321/33461 47321/33461)) (remainder (* 114243/80782 114243/80782) 2.0)) #f)
(test (= (remainder 47321/33461 114243/80782) (floor (/ 47321/33461 114243/80782))) #f)
(test (= (remainder (* 275807/195025 275807/195025) 2) (remainder (* 1607521/1136689 1607521/1136689) 2)) #f)
(test (= (remainder 2.0 (* 275807/195025 275807/195025)) (remainder (* 1607521/1136689 1607521/1136689) 2.0)) #f)
(test (= (remainder 275807/195025 1607521/1136689) (floor (/ 275807/195025 1607521/1136689))) #f)
(test (= (remainder (* 3880899/2744210 3880899/2744210) 2) (remainder (* 9369319/6625109 9369319/6625109) 2)) #f)
(test (= (remainder 2.0 (* 3880899/2744210 3880899/2744210)) (remainder (* 9369319/6625109 9369319/6625109) 2.0)) #f)
(test (= (remainder 3880899/2744210 9369319/6625109) (floor (/ 3880899/2744210 9369319/6625109))) #f)
(test (= (remainder (* 54608393/38613965 54608393/38613965) 2) (remainder (* 131836323/93222358 131836323/93222358) 2)) #f)
(test (= (remainder 2.0 (* 54608393/38613965 54608393/38613965)) (remainder (* 131836323/93222358 131836323/93222358) 2.0)) #f)
(test (= (remainder 54608393/38613965 131836323/93222358) (floor (/ 54608393/38613965 131836323/93222358))) #f)
(if with-bignums (test (= (remainder (* 318281039/225058681 318281039/225058681) 2) (remainder (* 1855077841/1311738121 1855077841/1311738121) 2)) #f))
(if with-bignums (test (= (remainder 2.0 (* 318281039/225058681 318281039/225058681)) (remainder (* 1855077841/1311738121 1855077841/1311738121) 2.0)) #f))
(if with-bignums (test (= (remainder 318281039/225058681 1855077841/1311738121) (floor (/ 318281039/225058681 1855077841/1311738121))) #f))

(num-test (+ (remainder 23/3 3/2) (* 3/2 (quotient 23/3 3/2))) 23/3)
(num-test (+ (remainder 29/8 17/12) (* 17/12 (quotient 29/8 17/12))) 29/8)
(num-test (+ (remainder 164/19 41/29) (* 41/29 (quotient 164/19 41/29))) 164/19)
(num-test (+ (remainder 725/84 99/70) (* 99/70 (quotient 725/84 99/70))) 725/84)
(num-test (+ (remainder 3862/401 577/408) (* 577/408 (quotient 3862/401 577/408))) 3862/401)
(num-test (+ (remainder 4881/1054 1393/985) (* 1393/985 (quotient 4881/1054 1393/985))) 4881/1054)
(num-test (+ (remainder 53963/20511 3363/2378) (* 3363/2378 (quotient 53963/20511 3363/2378))) 53963/20511)
(num-test (+ (remainder 188690/24727 19601/13860) (* 19601/13860 (quotient 188690/24727 19601/13860))) 188690/24727)
(num-test (+ (remainder 959536/125743 47321/33461) (* 47321/33461 (quotient 959536/125743 47321/33461))) 959536/125743)
(num-test (+ (remainder 2606489/301994 114243/80782) (* 114243/80782 (quotient 2606489/301994 114243/80782))) 2606489/301994)
(num-test (+ (remainder 97961303/11350029 275807/195025) (* 275807/195025 (quotient 97961303/11350029 275807/195025))) 97961303/11350029)
(num-test (+ (remainder 109303762/16483927 1607521/1136689) (* 1607521/1136689 (quotient 109303762/16483927 1607521/1136689))) 109303762/16483927)
(num-test (+ (remainder 27869189/17087915 3880899/2744210) (* 3880899/2744210 (quotient 27869189/17087915 3880899/2744210))) 27869189/17087915)
(num-test (+ (remainder 564541319/85137581 9369319/6625109) (* 9369319/6625109 (quotient 564541319/85137581 9369319/6625109))) 564541319/85137581)
(num-test (+ (remainder 2351934037/272500658 54608393/38613965) (* 54608393/38613965 (quotient 2351934037/272500658 54608393/38613965))) 2351934037/272500658)
(num-test (+ (remainder 1657851173/630138897 131836323/93222358) (* 131836323/93222358 (quotient 1657851173/630138897 131836323/93222358))) 1657851173/630138897)

(if with-bignums
    (begin
      (num-test (remainder -9223372036854775808 5.551115123125783999999999999999999999984E-17) -2.295798100238055639010781305842101573944E-17)
      (num-test (remainder 295147905149568077200 34359738366) 21754858894)
      (num-test (remainder 696898287454081973170944403677937368733396 1180591620717411303422) 314390899110894278354)
      (num-test (remainder 1e19 10) 0.0)
      (num-test (remainder .1e20 10) 0.0)
      (num-test (remainder 1e20 10) 0.0)
      (num-test (remainder 1e21 10) 0.0)
      (num-test (remainder 1e19 -1) 0.0)
      (num-test (remainder 1e19 1) 0.0)
      (num-test (remainder .1e20 1) 0.0)
      (num-test (remainder 1e20 1) 0.0)
      (num-test (remainder 10000000000000000000 1) 0)
      (num-test (remainder 100000000000000000000 1) 0)
      (num-test (remainder 10000000000000000000 10) 0)
      (num-test (remainder 100000000000000000000 10) 0)

      (num-test (remainder 9223372036854775807 1/3) 0)
      (num-test (remainder 9223372036854775807 2/3) 1/3)
      (num-test (remainder 922337203685477580 1/3) 0)
      (test (remainder 1361069299753299783990135442290762165844800+i 8281085446358585640) 'error)
      (test (remainder 1231231231231231232123 0.0) 'error)
      (test (remainder 1231231231231231232123 0) 'error)

      (test (= (remainder (* 4478554083/3166815962 4478554083/3166815962) 2) 
	       (remainder (* 10812186007/7645370045 10812186007/7645370045) 2)) #f)
      (test (= (remainder 2.0 (* 4478554083/3166815962 4478554083/3166815962)) 
	       (remainder (* 10812186007/7645370045 10812186007/7645370045) 2.0)) #f)
      (test (= (remainder 367296043199/259717522849 886731088897/627013566048) 
	       (floor (/ 367296043199/259717522849 886731088897/627013566048))) #f)
      (test (= (remainder (* 5168247530883/3654502875938 5168247530883/3654502875938) 2) 
	       (remainder (* 12477253282759/8822750406821 12477253282759/8822750406821) 2)) #f)
      (test (= (remainder 2.0 (* 423859315570607/299713796309065 423859315570607/299713796309065)) 
	       (remainder (* 1023286908188737/723573111879672 1023286908188737/723573111879672) 2.0)) #f)
      (test (= (remainder 2.0 (* 34761632124320657/24580185800219268 34761632124320657/24580185800219268)) 
	       (remainder (* 202605639573839043/143263821649299118 202605639573839043/143263821649299118) 2.0)) #f)
      (test (= (remainder 34761632124320657/24580185800219268 202605639573839043/143263821649299118) 
	       (floor (/ 34761632124320657/24580185800219268 202605639573839043/143263821649299118))) #f)
      (test (= (remainder (* 489133282872437279/345869461223138161 489133282872437279/345869461223138161) 2) 
	       (remainder (* 1180872205318713601/835002744095575440 1180872205318713601/835002744095575440) 2)) #f)
      (test (= (remainder (* 2850877693509864481/2015874949414289041 2850877693509864481/2015874949414289041) 2) 
	       (remainder (* 16616132878186749607/11749380235262596085 16616132878186749607/11749380235262596085) 2)) #f)
      (test (= (remainder (* 564459384575477049359/399133058537705128729 564459384575477049359/399133058537705128729) 2) 
	       (remainder (* 1362725501650887306817/963592443113182178088 1362725501650887306817/963592443113182178088) 2)) #f)
      (test (= (remainder 564459384575477049359/399133058537705128729 1362725501650887306817/963592443113182178088) 
	       (floor (/ 564459384575477049359/399133058537705128729 1362725501650887306817/963592443113182178088))) #f)
      (test (= (remainder (* 3289910387877251662993/2326317944764069484905 3289910387877251662993/2326317944764069484905) 2) 
	       (remainder (* 19175002942688032928599/13558774610046711780701 19175002942688032928599/13558774610046711780701) 2)) #f)
      (test (= (remainder (* 46292552162781456490001/32733777552734744709300 46292552162781456490001/32733777552734744709300) 2) 
	       (remainder (* 111760107268250945908601/79026329715516201199301 111760107268250945908601/79026329715516201199301) 2)) #f)
      (test (= (remainder 46292552162781456490001/32733777552734744709300 111760107268250945908601/79026329715516201199301) 
	       (floor (/ 46292552162781456490001/32733777552734744709300 111760107268250945908601/79026329715516201199301))) #f)
      (test (= (remainder (* 269812766699283348307203/190786436983767147107902 269812766699283348307203/190786436983767147107902) 2) 
	       (remainder (* 1572584048032918633353217/1111984844349868137938112 1572584048032918633353217/1111984844349868137938112) 2)) #f)
      (test (= (remainder 269812766699283348307203/190786436983767147107902 1572584048032918633353217/1111984844349868137938112) 
	       (floor (/ 269812766699283348307203/190786436983767147107902 1572584048032918633353217/1111984844349868137938112))) #f)

      (num-test (+ (remainder 37496514441/6659027209 318281039/225058681) 
		   (* 318281039/225058681 (quotient 37496514441/6659027209 318281039/225058681))) 37496514441/6659027209)
      (num-test (+ (remainder 74857297149/9809721694 1855077841/1311738121) 
		   (* 1855077841/1311738121 (quotient 74857297149/9809721694 1855077841/1311738121))) 74857297149/9809721694)
      (num-test (+ (remainder 48346261034/10439860591 4478554083/3166815962) 
		   (* 4478554083/3166815962 (quotient 48346261034/10439860591 4478554083/3166815962))) 48346261034/10439860591)
      (num-test (+ (remainder 584312948386/103768467013 10812186007/7645370045) 
		   (* 10812186007/7645370045 (quotient 584312948386/103768467013 10812186007/7645370045))) 584312948386/103768467013)
      (num-test (+ (remainder 1663365607631/217976794617 63018038201/44560482149) 
		   (* 63018038201/44560482149 (quotient 1663365607631/217976794617 63018038201/44560482149))) 1663365607631/217976794617)
      (num-test (+ (remainder 4518285376493/975675645481 152139002499/107578520350) 
		   (* 152139002499/107578520350 (quotient 4518285376493/975675645481 152139002499/107578520350))) 4518285376493/975675645481)
      (num-test (+ (remainder 10302330360665/1193652440098 367296043199/259717522849) 
		   (* 367296043199/259717522849 (quotient 10302330360665/1193652440098 367296043199/259717522849))) 10302330360665/1193652440098)
      (num-test (+ (remainder 73997654926903/8573543875303 886731088897/627013566048) 
		   (* 886731088897/627013566048 (quotient 73997654926903/8573543875303 886731088897/627013566048))) 73997654926903/8573543875303)
      (num-test (+ (remainder 176638380405175/18340740190704 5168247530883/3654502875938) 
		   (* 5168247530883/3654502875938 (quotient 176638380405175/18340740190704 5168247530883/3654502875938))) 176638380405175/18340740190704)
      (num-test (+ (remainder 468100074910801/83130157078217 12477253282759/8822750406821) 
		   (* 12477253282759/8822750406821 (quotient 468100074910801/83130157078217 12477253282759/8822750406821))) 468100074910801/83130157078217)
      (num-test (+ (remainder 843389138467141/517121682660006 30122754096401/21300003689580) 
		   (* 30122754096401/21300003689580 (quotient 843389138467141/517121682660006 30122754096401/21300003689580))) 843389138467141/517121682660006)
      (num-test (+ (remainder 1250127478260940/766512153894657 175568277047523/124145519261542) 
		   (* 175568277047523/124145519261542 (quotient 1250127478260940/766512153894657 175568277047523/124145519261542))) 1250127478260940/766512153894657)
      (num-test (+ (remainder 21963374527647665/6048967074079039 423859315570607/299713796309065) 
		   (* 423859315570607/299713796309065 (quotient 21963374527647665/6048967074079039 423859315570607/299713796309065))) 21963374527647665/6048967074079039)
      (num-test (+ (remainder 45760661301451259/9881527843552324 1023286908188737/723573111879672) 
		   (* 1023286908188737/723573111879672 (quotient 45760661301451259/9881527843552324 1023286908188737/723573111879672))) 45760661301451259/9881527843552324)
      (num-test (+ (remainder 1528546195606366451/177100989030047175 5964153172084899/4217293152016490) 
		   (* 5964153172084899/4217293152016490 (quotient 1528546195606366451/177100989030047175 5964153172084899/4217293152016490))) 1528546195606366451/177100989030047175)
      (num-test (+ (remainder 543933078269123234/206745572560704147 14398739476117879/10181446324101389) 
		   (* 14398739476117879/10181446324101389 (quotient 543933078269123234/206745572560704147 14398739476117879/10181446324101389))) 543933078269123234/206745572560704147)
      (num-test (+ (remainder 4808388068050040138/630118245525664765 34761632124320657/24580185800219268) 
		   (* 34761632124320657/24580185800219268 (quotient 4808388068050040138/630118245525664765 34761632124320657/24580185800219268))) 4808388068050040138/630118245525664765)

      ))

(test (remainder 123 123 123) 'error)
(test (remainder 123) 'error)
(test (remainder 3 0) 'error)
(test (remainder) 'error)
(test (remainder 2.3 1.0+0.1i) 'error)
(test (remainder 3.0+2.3i 3) 'error)
(test (remainder 3 0.0) 'error)

(for-each
 (lambda (arg)
   (test (remainder arg nan.0) 'error)
   (test (remainder nan.0 arg) 'error)
   (test (remainder arg inf.0) 'error)
   (test (remainder inf.0 arg) 'error)
   (test (remainder arg 2) 'error))
 (list "hi" '() (integer->char 65) 0+i #f #t '(1 2) _ht_ 'a-symbol (cons 1 2) (make-vector 3) abs 
       #<eof> '(1 2 3) #\newline (lambda (a) (+ a 1)) #<unspecified> #<undefined>))

(for-each
 (lambda (arg)
   (test (remainder 2 arg) 'error)
   (test (remainder 2.0 arg) 'error)
   (test (remainder 1/2 arg) 'error)
   (test (remainder 2+i arg) 'error))
 (list "hi" '() (integer->char 65) #f #t 0 0+i '(1 2) _ht_ 'a-symbol (cons 1 2) (make-vector 3) abs 
       #<eof> '(1 2 3) #\newline (lambda (a) (+ a 1)) #<unspecified> #<undefined>))


(if with-bignums
    (let ((top-exp 60))
      (let ((happy #t))
	(do ((i 2 (+ i 1)))
	    ((or (not happy) (> i top-exp)))
	  (let* ((val1 (inexact->exact (expt 2 i)))
		 (val2 (+ val1 1))
		 (mv (modulo val2 2))
		 (qv (quotient val2 2))
		 (rv (remainder val2 2)))
	    (if (not (= mv 1))
		(begin (set! happy #f) (display "(modulo ") (display val2) (display " 2) = ") (display mv) (display "?") (newline)))
	    (if (not (= qv (/ val1 2)))
		(begin (set! happy #f) (display "(quotient ") (display val2) (display " 2) = ") (display qv) (display "?") (newline)))
	    (if (not (= rv 1))
		(begin (set! happy #f) (display "(remainder ") (display val2) (display " 2) = ") (display rv) (display "?") (newline))))))
      
      (let ((happy #t))
	(do ((i 2 (+ i 1)))
	    ((or (not happy) (> i top-exp)))
	  (let* ((val1 (inexact->exact (expt 2 i)))
		 (val2 (/ (+ val1 1) 2))
		 (mv (modulo val2 2))
		 (qv (quotient val2 2))
		 (rv (remainder val2 2)))
	    (if (not (= mv 1/2))
		(begin (set! happy #f) (display "(modulo ") (display val2) (display " 2) = ") (display mv) (display "?") (newline)))
	    (if (not (= qv (/ val1 4)))
		(begin (set! happy #f) (display "(quotient ") (display val2) (display " 2) = ") (display qv) (display "?") (newline)))
	    (if (not (= rv 1/2))
		(begin (set! happy #f) (display "(remainder ") (display val2) (display " 2) = ") (display rv) (display "?") (newline))))))))

(if (not with-bignums)
    (begin
;      (test (modulo 1e20 10) 'error)
      (test (remainder 1e20 10) 'error)
      (test (quotient 1e20 10) 'error)))
